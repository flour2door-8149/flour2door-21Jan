{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///C:/Projects/Flour2door/app/store/add-product/page.jsx"],"sourcesContent":["'use client'\r\nimport { assets } from \"@/assets/assets\"\r\nimport { useAuth } from \"@clerk/nextjs\"\r\nimport axios from \"axios\"\r\nimport Image from \"next/image\"\r\nimport { useState } from \"react\"\r\nimport { toast } from \"react-hot-toast\"\r\n\r\nexport default function StoreAddProduct() {\r\n\r\n    const categories = ['Fresh','Upvas','special']\r\n\r\n    const [images, setImages] = useState({ 1: null, 2: null, 3: null, 4: null })\r\n    const [productInfo, setProductInfo] = useState({\r\n        name: \"\",\r\n        description: \"\",\r\n        mrp: 0,\r\n        price: 0,\r\n        category: \"\",\r\n    })\r\n    const [loading, setLoading] = useState(false)\r\n    const [aiUsed, setAiUsed] = useState(false)\r\n\r\n    const { getToken } = useAuth()\r\n\r\n    const onChangeHandler = (e) => {\r\n        setProductInfo({ ...productInfo, [e.target.name]: e.target.value })\r\n    }\r\n\r\n    const handleImageUpload = async (key, file) => {\r\n        setImages(prev => ({ ...prev, [key]: file }))\r\n\r\n        if (key === \"1\" && file && !aiUsed) {\r\n            const reader = new FileReader()\r\n            reader.readAsDataURL(file)\r\n            reader.onloadend = async () => {\r\n                const base64String = reader.result.split(\",\")[1]\r\n                const mimeType = file.type\r\n                const token = await getToken()\r\n\r\n                try {\r\n                    await toast.promise(\r\n                        axios.post(\r\n                            \"/api/store/ai\",\r\n                            { base64Image: base64String, mimeType },\r\n                            { headers: { Authorization: `Bearer ${token}` } }\r\n                        ),\r\n                        {\r\n                            loading: \"Analyzing image with AI...\",\r\n                            success: (res) => {\r\n                                console.log(res);\r\n                                \r\n                                const data = res.data\r\n                                if (data.name && data.description) {\r\n                                    setProductInfo(prev => ({\r\n                                        ...prev,\r\n                                        name: data.name,\r\n                                        description: data.description\r\n                                    }))\r\n                                    setAiUsed(true)\r\n                                    return \"AI filled product info ðŸŽ‰\"\r\n                                }\r\n                                return \"AI could not analyze the image\"\r\n                            },\r\n                            error: (err) =>\r\n                                err?.response?.data?.error || err.message\r\n                        }\r\n                    )\r\n                } catch (error) {\r\n                    console.error(error)\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    const onSubmitHandler = async (e) => {\r\n        e.preventDefault()\r\n        try {\r\n            if (!images[1] && !images[2] && !images[3] && !images[4]) {\r\n                return toast.error('Please upload at least one image')\r\n            }\r\n            setLoading(true)\r\n\r\n            const formData = new FormData()\r\n            formData.append('name', productInfo.name)\r\n            formData.append('description', productInfo.description)\r\n            formData.append('mrp', productInfo.mrp)\r\n            formData.append('price', productInfo.price)\r\n            formData.append('category', productInfo.category)\r\n\r\n            Object.keys(images).forEach((key) => {\r\n                images[key] && formData.append('images', images[key])\r\n            })\r\n\r\n            const token = await getToken()\r\n            const { data } = await axios.post('/api/store/product', formData, { headers: { Authorization: `Bearer ${token}` } })\r\n            toast.success(data.message)\r\n\r\n            setProductInfo({ name: \"\", description: \"\", mrp: 0, price: 0, category: \"\" })\r\n            setImages({ 1: null, 2: null, 3: null, 4: null })\r\n            setAiUsed(false)\r\n        } catch (error) {\r\n            toast.error(error?.response?.data?.error || error.message)\r\n        } finally {\r\n            setLoading(false)\r\n        }\r\n    }\r\n\r\n    return (\r\n        <form onSubmit={e => toast.promise(onSubmitHandler(e), { loading: \"Adding Product...\" })} className=\"text-slate-500 mb-28\">\r\n            <h1 className=\"text-2xl\">Add New <span className=\"text-slate-800 font-medium\">Products</span></h1>\r\n            <p className=\"mt-7\">Product Images</p>\r\n\r\n            <div className=\"flex gap-3 mt-4\">\r\n                {Object.keys(images).map((key) => (\r\n                    <label key={key} htmlFor={`images${key}`}>\r\n                        <Image\r\n                            width={300}\r\n                            height={300}\r\n                            className='h-15 w-auto border border-slate-200 rounded cursor-pointer'\r\n                            src={images[key] ? URL.createObjectURL(images[key]) : assets.upload_area}\r\n                            alt=\"\"\r\n                        />\r\n                        <input\r\n                            type=\"file\"\r\n                            accept='image/*'\r\n                            id={`images${key}`}\r\n                            onChange={e => handleImageUpload(key, e.target.files[0])}\r\n                            hidden\r\n                        />\r\n                    </label>\r\n                ))}\r\n            </div>\r\n\r\n            <label className=\"flex flex-col gap-2 my-6 \">\r\n                Name\r\n                <input type=\"text\" name=\"name\" onChange={onChangeHandler} value={productInfo.name} placeholder=\"Enter product name\" className=\"w-full max-w-sm p-2 px-4 outline-none border border-slate-200 rounded\" required />\r\n            </label>\r\n\r\n            <label className=\"flex flex-col gap-2 my-6 \">\r\n                Description\r\n                <textarea name=\"description\" onChange={onChangeHandler} value={productInfo.description} placeholder=\"Enter product description\" rows={5} className=\"w-full max-w-sm p-2 px-4 outline-none border border-slate-200 rounded resize-none\" required />\r\n            </label>\r\n\r\n            <div className=\"flex gap-5\">\r\n                <label className=\"flex flex-col gap-2 \">\r\n                    Actual Price (â‚¹)\r\n                    <input type=\"number\" name=\"mrp\" onChange={onChangeHandler} value={productInfo.mrp} placeholder=\"0\" className=\"w-full max-w-45 p-2 px-4 outline-none border border-slate-200 rounded\" required />\r\n                </label>\r\n                <label className=\"flex flex-col gap-2 \">\r\n                    Offer Price (â‚¹)\r\n                    <input type=\"number\" name=\"price\" onChange={onChangeHandler} value={productInfo.price} placeholder=\"0\" className=\"w-full max-w-45 p-2 px-4 outline-none border border-slate-200 rounded\" required />\r\n                </label>\r\n            </div>\r\n\r\n            <select onChange={e => setProductInfo({ ...productInfo, category: e.target.value })} value={productInfo.category} className=\"w-full max-w-sm p-2 px-4 my-6 outline-none border border-slate-200 rounded\" required>\r\n                <option value=\"\">Select a category</option>\r\n                {categories.map((category) => (\r\n                    <option key={category} value={category}>{category}</option>\r\n                ))}\r\n            </select>\r\n\r\n            <br />\r\n\r\n            <button disabled={loading} className=\"bg-slate-800 text-white px-6 mt-7 py-2 hover:bg-slate-900 rounded transition\">Add Product</button>\r\n        </form>\r\n    )\r\n}\r\n"],"names":[],"mappings":"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","debugId":null}}]
}