{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///C:/Projects/Flour2door/app/store/orders/page.jsx"],"sourcesContent":["'use client'\r\nimport { useEffect, useState } from \"react\"\r\nimport Loading from \"@/components/Loading\"\r\nimport { orderDummyData } from \"@/assets/assets\"\r\nimport { useAuth } from \"@clerk/nextjs\"\r\nimport axios from \"axios\"\r\nimport toast from \"react-hot-toast\"\r\n\r\nexport default function StoreOrders() {\r\n    const [orders, setOrders] = useState([])\r\n    const [loading, setLoading] = useState(true)\r\n    const [selectedOrder, setSelectedOrder] = useState(null)\r\n    const [isModalOpen, setIsModalOpen] = useState(false)\r\n\r\n\r\n    const { getToken } = useAuth()\r\n\r\n    const fetchOrders = async () => {\r\n       try {\r\n        const token = await getToken()\r\n        const { data } = await axios.get('/api/store/orders', {headers: { Authorization: `Bearer ${token}` }})\r\n        setOrders(data.orders)\r\n       } catch (error) {\r\n        toast.error(error?.response?.data?.error || error.message)\r\n       }finally{\r\n        setLoading(false)\r\n       }\r\n    }\r\n\r\n    const updateOrderStatus = async (orderId, status) => {\r\n        try {\r\n            const token = await getToken()\r\n            await axios.post('/api/store/orders',{orderId, status}, {headers: { Authorization: `Bearer ${token}` }})\r\n            setOrders(prev =>\r\n                prev.map(order => \r\n                    order.id === orderId ? {...order, status} : order\r\n                )\r\n            )\r\n            toast.success('Order status updated!')\r\n       } catch (error) {\r\n            toast.error(error?.response?.data?.error || error.message)\r\n       }\r\n    }\r\n\r\n    const openModal = (order) => {\r\n        setSelectedOrder(order)\r\n        setIsModalOpen(true)\r\n    }\r\n\r\n    const closeModal = () => {\r\n        setSelectedOrder(null)\r\n        setIsModalOpen(false)\r\n    }\r\n\r\n    useEffect(() => {\r\n        fetchOrders()\r\n    }, [])\r\n\r\n    if (loading) return <Loading />\r\n\r\n    return (\r\n        <>\r\n            <h1 className=\"text-2xl text-slate-500 mb-5\">Store <span className=\"text-slate-800 font-medium\">Orders</span></h1>\r\n            {orders.length === 0 ? (\r\n                <p>No orders found</p>\r\n            ) : (\r\n                <div className=\"overflow-x-auto max-w-4xl rounded-md shadow border border-gray-200\">\r\n                    <table className=\"w-full text-sm text-left text-gray-600\">\r\n                        <thead className=\"bg-gray-50 text-gray-700 text-xs uppercase tracking-wider\">\r\n                            <tr>\r\n                                {[\"Sr. No.\", \"Customer\", \"Total\", \"Payment\", \"Coupon\", \"Status\", \"Date\"].map((heading, i) => (\r\n                                    <th key={i} className=\"px-4 py-3\">{heading}</th>\r\n                                ))}\r\n                            </tr>\r\n                        </thead>\r\n                        <tbody className=\"divide-y divide-gray-100\">\r\n                            {orders.map((order, index) => (\r\n                                <tr\r\n                                    key={order.id}\r\n                                    className=\"hover:bg-gray-50 transition-colors duration-150 cursor-pointer\"\r\n                                    onClick={() => openModal(order)}\r\n                                >\r\n                                    <td className=\"pl-6 text-green-600\" >\r\n                                        {index + 1}\r\n                                    </td>\r\n                                    <td className=\"px-4 py-3\">{order.user?.name}</td>\r\n                                    <td className=\"px-4 py-3 font-medium text-slate-800\">₹{order.total}</td>\r\n                                    <td className=\"px-4 py-3\">{order.paymentMethod}</td>\r\n                                    <td className=\"px-4 py-3\">\r\n                                        {order.isCouponUsed ? (\r\n                                            <span className=\"bg-green-100 text-green-700 text-xs px-2 py-1 rounded-full\">\r\n                                                {order.coupon?.code}\r\n                                            </span>\r\n                                        ) : (\r\n                                            \"—\"\r\n                                        )}\r\n                                    </td>\r\n                                    <td className=\"px-4 py-3\" onClick={(e) => { e.stopPropagation() }}>\r\n                                        <select\r\n                                            value={order.status}\r\n                                            onChange={e => updateOrderStatus(order.id, e.target.value)}\r\n                                            className=\"border-gray-300 rounded-md text-sm focus:ring focus:ring-blue-200\"\r\n                                        >\r\n                                            <option value=\"ORDER_PLACED\">ORDER_PLACED</option>\r\n                                            <option value=\"PROCESSING\">PROCESSING</option>\r\n                                            <option value=\"SHIPPED\">SHIPPED</option>\r\n                                            <option value=\"DELIVERED\">DELIVERED</option>\r\n                                        </select>\r\n                                    </td>\r\n                                    <td className=\"px-4 py-3 text-gray-500\">\r\n                                        {new Date(order.createdAt).toLocaleString()}\r\n                                    </td>\r\n                                </tr>\r\n                            ))}\r\n                        </tbody>\r\n                    </table>\r\n                </div>\r\n            )}\r\n\r\n            {/* Modal */}\r\n            {isModalOpen && selectedOrder && (\r\n                <div onClick={closeModal} className=\"fixed inset-0 flex items-center justify-center bg-black/50 text-slate-700 text-sm backdrop-blur-xs z-50\" >\r\n                    <div onClick={e => e.stopPropagation()} className=\"bg-white rounded-lg shadow-lg max-w-2xl w-full p-6 relative\">\r\n                        <h2 className=\"text-xl font-semibold text-slate-900 mb-4 text-center\">\r\n                            Order Details\r\n                        </h2>\r\n\r\n                        {/* Customer Details */}\r\n                        <div className=\"mb-4\">\r\n                            <h3 className=\"font-semibold mb-2\">Customer Details</h3>\r\n                            <p><span className=\"text-green-700\">Name:</span> {selectedOrder.user?.name}</p>\r\n                            <p><span className=\"text-green-700\">Email:</span> {selectedOrder.user?.email}</p>\r\n                            <p><span className=\"text-green-700\">Phone:</span> {selectedOrder.address?.phone}</p>\r\n                            <p><span className=\"text-green-700\">Address:</span> {`${selectedOrder.address?.street}, ${selectedOrder.address?.city}, ${selectedOrder.address?.state}, ${selectedOrder.address?.zip}, ${selectedOrder.address?.country}`}</p>\r\n                        </div>\r\n\r\n                        {/* Products */}\r\n                        <div className=\"mb-4\">\r\n                            <h3 className=\"font-semibold mb-2\">Products</h3>\r\n                            <div className=\"space-y-2\">\r\n                                {selectedOrder.orderItems.map((item, i) => (\r\n                                    <div key={i} className=\"flex items-center gap-4 border border-slate-100 shadow rounded p-2\">\r\n                                        <img\r\n                                            src={item.product?.images?.[0]}\r\n                                            alt={item.product?.name}\r\n                                            className=\"w-16 h-16 object-cover rounded\"\r\n                                        />\r\n                                        <div className=\"flex-1\">\r\n                                            <p className=\"text-slate-800\">{item.product?.name}</p>\r\n                                            <p>Qty: {item.quantity}</p>\r\n                                            <p>Price: ₹{item.price}</p>\r\n                                        </div>\r\n                                    </div>\r\n                                ))}\r\n                            </div>\r\n                        </div>\r\n\r\n                        {/* Payment & Status */}\r\n                        <div className=\"mb-4\">\r\n                            <p><span className=\"text-green-700\">Payment Method:</span> {selectedOrder.paymentMethod}</p>\r\n                            <p><span className=\"text-green-700\">Paid:</span> {selectedOrder.isPaid ? \"Yes\" : \"No\"}</p>\r\n                            {selectedOrder.isCouponUsed && (\r\n                                <p><span className=\"text-green-700\">Coupon:</span> {selectedOrder.coupon.code} ({selectedOrder.coupon.discount}% off)</p>\r\n                            )}\r\n                            <p><span className=\"text-green-700\">Status:</span> {selectedOrder.status}</p>\r\n                            <p><span className=\"text-green-700\">Order Date:</span> {new Date(selectedOrder.createdAt).toLocaleString()}</p>\r\n                        </div>\r\n\r\n                        {/* Actions */}\r\n                        <div className=\"flex justify-end\">\r\n                            <button onClick={closeModal} className=\"px-4 py-2 bg-slate-200 rounded hover:bg-slate-300\" >\r\n                                Close\r\n                            </button>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            )}\r\n        </>\r\n    )\r\n}\r\n"],"names":[],"mappings":"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","debugId":null}}]
}