{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 3, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"","debugId":null}},
    {"offset": {"line": 37, "column": 0}, "map": {"version":3,"sources":["file:///C:/Projects/Flour2door/configs/openai.js"],"sourcesContent":["import OpenAI from \"openai\";\r\n\r\nexport const openai = new OpenAI({\r\n  apiKey: process.env.OPENAI_API_KEY,\r\n  baseURL: process.env.OPENAI_BASE_URL,\r\n});\r\n\r\n"],"names":[],"mappings":";;;;AAAA;AAAA;;AAEO,MAAM,SAAS,IAAI,mLAAM,CAAC;IAC/B,QAAQ,QAAQ,GAAG,CAAC,cAAc;IAClC,SAAS,QAAQ,GAAG,CAAC,eAAe;AACtC","debugId":null}},
    {"offset": {"line": 118, "column": 0}, "map": {"version":3,"sources":["file:///C:/Projects/Flour2door/lib/prisma.js"],"sourcesContent":["import { PrismaClient } from '@prisma/client';\r\nimport { PrismaNeon } from '@prisma/adapter-neon';\r\nimport { neonConfig } from '@neondatabase/serverless';\r\n\r\nimport ws from 'ws';\r\nneonConfig.webSocketConstructor = ws; \r\n\r\n// To work in edge environments (Cloudflare Workers, Vercel Edge, etc.), enable querying over fetch\r\nneonConfig.poolQueryViaFetch = true\r\n\r\n// Type definitions\r\n// declare global {\r\n//   var prisma: PrismaClient | undefined\r\n// }\r\n\r\nconst connectionString = `${process.env.DATABASE_URL}`;\r\n\r\nconst adapter = new PrismaNeon({ connectionString });\r\nconst prisma = global.prisma || new PrismaClient(process.env.NEXT_RUNTIME === \"edge\" ? { adapter } : {});\r\n\r\nif (process.env.NEXT_RUNTIME !== 'edge') global.prisma = prisma;\r\n\r\nexport default prisma; "],"names":[],"mappings":";;;;AAAA;AACA;AACA;AAEA;;;;;AACA,sKAAU,CAAC,oBAAoB,GAAG,2JAAE;AAEpC,mGAAmG;AACnG,sKAAU,CAAC,iBAAiB,GAAG;AAE/B,mBAAmB;AACnB,mBAAmB;AACnB,yCAAyC;AACzC,IAAI;AAEJ,MAAM,mBAAmB,GAAG,QAAQ,GAAG,CAAC,YAAY,EAAE;AAEtD,MAAM,UAAU,IAAI,6KAAU,CAAC;IAAE;AAAiB;AAClD,MAAM,SAAS,yDAAO,MAAM,IAAI,IAAI,6IAAY,CAAC,sCAAsC,0BAAc,CAAC;AAEtG,wCAAyC,yDAAO,MAAM,GAAG;uCAE1C","debugId":null}},
    {"offset": {"line": 148, "column": 0}, "map": {"version":3,"sources":["file:///C:/Projects/Flour2door/middlewares/authSeller.js"],"sourcesContent":["import prisma from '@/lib/prisma';\r\n\r\n\r\nconst authSeller = async (userId) => {\r\n    try {\r\n        const user = await prisma.user.findUnique({\r\n            where: { id: userId },\r\n            include: { store: true },\r\n        })\r\n\r\n        if(user.store){\r\n            if(user.store.status === 'approved'){\r\n                return user.store.id\r\n            }\r\n        }else{\r\n            return false\r\n        }\r\n    } catch (error) {\r\n        console.error(error)\r\n        return false\r\n    }\r\n}\r\n\r\nexport default authSeller"],"names":[],"mappings":";;;;AAAA;;AAGA,MAAM,aAAa,OAAO;IACtB,IAAI;QACA,MAAM,OAAO,MAAM,0HAAM,CAAC,IAAI,CAAC,UAAU,CAAC;YACtC,OAAO;gBAAE,IAAI;YAAO;YACpB,SAAS;gBAAE,OAAO;YAAK;QAC3B;QAEA,IAAG,KAAK,KAAK,EAAC;YACV,IAAG,KAAK,KAAK,CAAC,MAAM,KAAK,YAAW;gBAChC,OAAO,KAAK,KAAK,CAAC,EAAE;YACxB;QACJ,OAAK;YACD,OAAO;QACX;IACJ,EAAE,OAAO,OAAO;QACZ,QAAQ,KAAK,CAAC;QACd,OAAO;IACX;AACJ;uCAEe","debugId":null}},
    {"offset": {"line": 199, "column": 0}, "map": {"version":3,"sources":["file:///C:/Projects/Flour2door/app/api/store/ai/route.js"],"sourcesContent":["import { openai } from \"@/configs/openai\";\r\nimport authSeller from \"@/middlewares/authSeller\";\r\nimport { getAuth } from \"@clerk/nextjs/server\";\r\nimport { NextResponse } from \"next/server\";\r\n\r\nasync function main(base64Image, mimeType) {\r\n    const messages = [\r\n        {\r\n            role: \"system\",\r\n            content: `\r\n                        You are a product listing assistant for an e-commerce store.\r\n                        Your job is to analyze an image of a product and generate structured data.\r\n\r\n                        Respond ONLY with raw JSON (no code block, no markdown, no explanation).\r\n                        The JSON must strictly follow this schema:\r\n\r\n                        {\r\n                        \"name\": string,               // Short product name\r\n                        \"description\": string,         // Marketing-friendly description of the product\r\n                        }\r\n                   `\r\n        },\r\n        {\r\n            role: \"user\",\r\n            content: [\r\n                { type: \"text\", text: \"Analyze this image and return name + description.\" },\r\n                { type: \"image_url\", image_url: { url: `data:${mimeType};base64,${base64Image}` } },\r\n            ],\r\n        },\r\n    ];\r\n\r\n    const response = await openai.chat.completions.create({\r\n        model: process.env.OPENAI_MODEL,\r\n        messages,\r\n    });\r\n\r\n    const raw = response.choices[0].message.content;\r\n    console.log(raw);\r\n\r\n    // remove ```json or ``` wrappers if present\r\n    const cleaned = raw.replace(/```json|```/g, \"\").trim();\r\n\r\n    let parsed;\r\n    try {\r\n        parsed = JSON.parse(cleaned);\r\n    } catch {\r\n        throw new Error(\"AI did not return valid JSON\");\r\n    }\r\n\r\n    return parsed;\r\n\r\n}\r\n\r\n\r\nexport async function POST(request) {\r\n    try {\r\n        const { userId } = getAuth(request)\r\n        const isAdmin = await authSeller(userId);\r\n        if (!isAdmin) {\r\n            return NextResponse.json({ error: 'not authorized' }, { status: 401 })\r\n        }\r\n        const { base64Image, mimeType } = await request.json();\r\n        const result = await main(base64Image, mimeType);\r\n        return NextResponse.json({ ...result });\r\n    } catch (error) {\r\n        console.error(error);\r\n        return NextResponse.json({ error: error.code || error.message }, { status: 400 });\r\n    }\r\n}\r\n"],"names":[],"mappings":";;;;AAAA;AACA;AACA;AACA;;;;;AAEA,eAAe,KAAK,WAAW,EAAE,QAAQ;IACrC,MAAM,WAAW;QACb;YACI,MAAM;YACN,SAAS,CAAC;;;;;;;;;;;mBAWH,CAAC;QACZ;QACA;YACI,MAAM;YACN,SAAS;gBACL;oBAAE,MAAM;oBAAQ,MAAM;gBAAoD;gBAC1E;oBAAE,MAAM;oBAAa,WAAW;wBAAE,KAAK,CAAC,KAAK,EAAE,SAAS,QAAQ,EAAE,aAAa;oBAAC;gBAAE;aACrF;QACL;KACH;IAED,MAAM,WAAW,MAAM,6HAAM,CAAC,IAAI,CAAC,WAAW,CAAC,MAAM,CAAC;QAClD,OAAO,QAAQ,GAAG,CAAC,YAAY;QAC/B;IACJ;IAEA,MAAM,MAAM,SAAS,OAAO,CAAC,EAAE,CAAC,OAAO,CAAC,OAAO;IAC/C,QAAQ,GAAG,CAAC;IAEZ,4CAA4C;IAC5C,MAAM,UAAU,IAAI,OAAO,CAAC,gBAAgB,IAAI,IAAI;IAEpD,IAAI;IACJ,IAAI;QACA,SAAS,KAAK,KAAK,CAAC;IACxB,EAAE,OAAM;QACJ,MAAM,IAAI,MAAM;IACpB;IAEA,OAAO;AAEX;AAGO,eAAe,KAAK,OAAO;IAC9B,IAAI;QACA,MAAM,EAAE,MAAM,EAAE,GAAG,IAAA,wLAAO,EAAC;QAC3B,MAAM,UAAU,MAAM,IAAA,sIAAU,EAAC;QACjC,IAAI,CAAC,SAAS;YACV,OAAO,gJAAY,CAAC,IAAI,CAAC;gBAAE,OAAO;YAAiB,GAAG;gBAAE,QAAQ;YAAI;QACxE;QACA,MAAM,EAAE,WAAW,EAAE,QAAQ,EAAE,GAAG,MAAM,QAAQ,IAAI;QACpD,MAAM,SAAS,MAAM,KAAK,aAAa;QACvC,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE,GAAG,MAAM;QAAC;IACzC,EAAE,OAAO,OAAO;QACZ,QAAQ,KAAK,CAAC;QACd,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE,OAAO,MAAM,IAAI,IAAI,MAAM,OAAO;QAAC,GAAG;YAAE,QAAQ;QAAI;IACnF;AACJ","debugId":null}}]
}