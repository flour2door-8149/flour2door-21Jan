{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 3, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"","debugId":null}},
    {"offset": {"line": 97, "column": 0}, "map": {"version":3,"sources":["file:///C:/Projects/Flour2door/inngest/client.js"],"sourcesContent":["import { Inngest } from \"inngest\";\r\n\r\n// Create a client to send and receive events\r\nexport const inngest = new Inngest({ id: \"Flour2Door-ecommerce\" });"],"names":[],"mappings":";;;;AAAA;;AAGO,MAAM,UAAU,IAAI,6IAAO,CAAC;IAAE,IAAI;AAAuB","debugId":null}},
    {"offset": {"line": 146, "column": 0}, "map": {"version":3,"sources":["file:///C:/Projects/Flour2door/lib/prisma.js"],"sourcesContent":["import { PrismaClient } from '@prisma/client';\r\nimport { PrismaNeon } from '@prisma/adapter-neon';\r\nimport { neonConfig } from '@neondatabase/serverless';\r\n\r\nimport ws from 'ws';\r\nneonConfig.webSocketConstructor = ws; \r\n\r\n// To work in edge environments (Cloudflare Workers, Vercel Edge, etc.), enable querying over fetch\r\nneonConfig.poolQueryViaFetch = true\r\n\r\n// Type definitions\r\n// declare global {\r\n//   var prisma: PrismaClient | undefined\r\n// }\r\n\r\nconst connectionString = `${process.env.DATABASE_URL}`;\r\n\r\nconst adapter = new PrismaNeon({ connectionString });\r\nconst prisma = global.prisma || new PrismaClient(process.env.NEXT_RUNTIME === \"edge\" ? { adapter } : {});\r\n\r\nif (process.env.NEXT_RUNTIME !== 'edge') global.prisma = prisma;\r\n\r\nexport default prisma; "],"names":[],"mappings":";;;;AAAA;AACA;AACA;AAEA;;;;;AACA,sKAAU,CAAC,oBAAoB,GAAG,2JAAE;AAEpC,mGAAmG;AACnG,sKAAU,CAAC,iBAAiB,GAAG;AAE/B,mBAAmB;AACnB,mBAAmB;AACnB,yCAAyC;AACzC,IAAI;AAEJ,MAAM,mBAAmB,GAAG,QAAQ,GAAG,CAAC,YAAY,EAAE;AAEtD,MAAM,UAAU,IAAI,6KAAU,CAAC;IAAE;AAAiB;AAClD,MAAM,SAAS,yDAAO,MAAM,IAAI,IAAI,6IAAY,CAAC,sCAAsC,0BAAc,CAAC;AAEtG,wCAAyC,yDAAO,MAAM,GAAG;uCAE1C","debugId":null}},
    {"offset": {"line": 194, "column": 0}, "map": {"version":3,"sources":["file:///C:/Projects/Flour2door/middlewares/authAdmin.js"],"sourcesContent":["import { clerkClient } from \"@clerk/nextjs/server\"\r\n\r\n\r\nconst authAdmin = async (userId) => {\r\n    try {\r\n        if(!userId) return false\r\n\r\n        const client = await clerkClient()\r\n        const user = await client.users.getUser(userId)\r\n\r\n        return process.env.ADMIN_EMAIL.split(',').includes(user.emailAddresses[0].emailAddress)\r\n    } catch (error) {\r\n        console.error(error)\r\n        return false\r\n    }\r\n}\r\n\r\nexport default authAdmin"],"names":[],"mappings":";;;;AAAA;;AAGA,MAAM,YAAY,OAAO;IACrB,IAAI;QACA,IAAG,CAAC,QAAQ,OAAO;QAEnB,MAAM,SAAS,MAAM,IAAA,0LAAW;QAChC,MAAM,OAAO,MAAM,OAAO,KAAK,CAAC,OAAO,CAAC;QAExC,OAAO,QAAQ,GAAG,CAAC,WAAW,CAAC,KAAK,CAAC,KAAK,QAAQ,CAAC,KAAK,cAAc,CAAC,EAAE,CAAC,YAAY;IAC1F,EAAE,OAAO,OAAO;QACZ,QAAQ,KAAK,CAAC;QACd,OAAO;IACX;AACJ;uCAEe","debugId":null}},
    {"offset": {"line": 216, "column": 0}, "map": {"version":3,"sources":["file:///C:/Projects/Flour2door/app/api/admin/coupon/route.js"],"sourcesContent":["import { inngest } from \"@/inngest/client\";\r\nimport prisma from \"@/lib/prisma\";\r\nimport authAdmin from \"@/middlewares/authAdmin\";\r\nimport { getAuth } from \"@clerk/nextjs/server\";\r\nimport { NextResponse } from \"next/server\";\r\n\r\n\r\n// Add new coupon\r\nexport async function POST(request){\r\n    try {\r\n        const { userId } = getAuth(request)\r\n        const isAdmin = await authAdmin(userId)\r\n\r\n        if (!isAdmin) {\r\n            return NextResponse.json({ error: \"not authorized\" }, { status: 401 })\r\n        }\r\n\r\n        const { coupon } = await request.json()\r\n        coupon.code = coupon.code.toUpperCase()\r\n\r\n        await prisma.coupon.create({data: coupon}).then(async (coupon) => {\r\n            // Run Inngest Sheduler Function to delete coupon on expire\r\n            await inngest.send({\r\n                name: \"app/coupon.expired\",\r\n                data: {\r\n                    code: coupon.code,\r\n                    expires_at: coupon.expiresAt,\r\n                }\r\n            })\r\n        })\r\n\r\n        return NextResponse.json({message: \"Coupon added successfully\"})\r\n\r\n    } catch (error) {\r\n        console.error(error)\r\n        return NextResponse.json({ error: error.code || error.message }, { status: 400 })\r\n    }\r\n}\r\n\r\n// Delete coupon  /api/coupon?id=couponId\r\nexport async function DELETE(request){\r\n    try {\r\n        const { userId } = getAuth(request)\r\n        const isAdmin = await authAdmin(userId)\r\n\r\n        if (!isAdmin) {\r\n            return NextResponse.json({ error: \"not authorized\" }, { status: 401 })\r\n        }\r\n\r\n        const { searchParams } = request.nextUrl;\r\n        const code = searchParams.get('code')\r\n\r\n        await prisma.coupon.delete({where: { code }})\r\n        return NextResponse.json({ message: 'Coupon deleted successfully' })\r\n    } catch (error) {\r\n        console.error(error)\r\n        return NextResponse.json({ error: error.code || error.message }, { status: 400 })\r\n    }\r\n}\r\n\r\n// Get all coupons\r\nexport async function GET(request){\r\n    try {\r\n        const { userId } = getAuth(request)\r\n        const isAdmin = await authAdmin(userId)\r\n\r\n        if (!isAdmin) {\r\n            return NextResponse.json({ error: \"not authorized\" }, { status: 401 })\r\n        }\r\n        const coupons = await prisma.coupon.findMany({})\r\n        return NextResponse.json({ coupons })\r\n    } catch (error) {\r\n        console.error(error)\r\n        return NextResponse.json({ error: error.code || error.message }, { status: 400 })\r\n    }\r\n}"],"names":[],"mappings":";;;;;;;;AAAA;AACA;AACA;AACA;AACA;;;;;;AAIO,eAAe,KAAK,OAAO;IAC9B,IAAI;QACA,MAAM,EAAE,MAAM,EAAE,GAAG,IAAA,wLAAO,EAAC;QAC3B,MAAM,UAAU,MAAM,IAAA,qIAAS,EAAC;QAEhC,IAAI,CAAC,SAAS;YACV,OAAO,gJAAY,CAAC,IAAI,CAAC;gBAAE,OAAO;YAAiB,GAAG;gBAAE,QAAQ;YAAI;QACxE;QAEA,MAAM,EAAE,MAAM,EAAE,GAAG,MAAM,QAAQ,IAAI;QACrC,OAAO,IAAI,GAAG,OAAO,IAAI,CAAC,WAAW;QAErC,MAAM,0HAAM,CAAC,MAAM,CAAC,MAAM,CAAC;YAAC,MAAM;QAAM,GAAG,IAAI,CAAC,OAAO;YACnD,2DAA2D;YAC3D,MAAM,8HAAO,CAAC,IAAI,CAAC;gBACf,MAAM;gBACN,MAAM;oBACF,MAAM,OAAO,IAAI;oBACjB,YAAY,OAAO,SAAS;gBAChC;YACJ;QACJ;QAEA,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAC,SAAS;QAA2B;IAElE,EAAE,OAAO,OAAO;QACZ,QAAQ,KAAK,CAAC;QACd,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE,OAAO,MAAM,IAAI,IAAI,MAAM,OAAO;QAAC,GAAG;YAAE,QAAQ;QAAI;IACnF;AACJ;AAGO,eAAe,OAAO,OAAO;IAChC,IAAI;QACA,MAAM,EAAE,MAAM,EAAE,GAAG,IAAA,wLAAO,EAAC;QAC3B,MAAM,UAAU,MAAM,IAAA,qIAAS,EAAC;QAEhC,IAAI,CAAC,SAAS;YACV,OAAO,gJAAY,CAAC,IAAI,CAAC;gBAAE,OAAO;YAAiB,GAAG;gBAAE,QAAQ;YAAI;QACxE;QAEA,MAAM,EAAE,YAAY,EAAE,GAAG,QAAQ,OAAO;QACxC,MAAM,OAAO,aAAa,GAAG,CAAC;QAE9B,MAAM,0HAAM,CAAC,MAAM,CAAC,MAAM,CAAC;YAAC,OAAO;gBAAE;YAAK;QAAC;QAC3C,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE,SAAS;QAA8B;IACtE,EAAE,OAAO,OAAO;QACZ,QAAQ,KAAK,CAAC;QACd,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE,OAAO,MAAM,IAAI,IAAI,MAAM,OAAO;QAAC,GAAG;YAAE,QAAQ;QAAI;IACnF;AACJ;AAGO,eAAe,IAAI,OAAO;IAC7B,IAAI;QACA,MAAM,EAAE,MAAM,EAAE,GAAG,IAAA,wLAAO,EAAC;QAC3B,MAAM,UAAU,MAAM,IAAA,qIAAS,EAAC;QAEhC,IAAI,CAAC,SAAS;YACV,OAAO,gJAAY,CAAC,IAAI,CAAC;gBAAE,OAAO;YAAiB,GAAG;gBAAE,QAAQ;YAAI;QACxE;QACA,MAAM,UAAU,MAAM,0HAAM,CAAC,MAAM,CAAC,QAAQ,CAAC,CAAC;QAC9C,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE;QAAQ;IACvC,EAAE,OAAO,OAAO;QACZ,QAAQ,KAAK,CAAC;QACd,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE,OAAO,MAAM,IAAI,IAAI,MAAM,OAAO;QAAC,GAAG;YAAE,QAAQ;QAAI;IACnF;AACJ","debugId":null}}]
}